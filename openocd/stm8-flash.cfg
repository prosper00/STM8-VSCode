proc program_device {filename flashstart} {
halt
wait_halt
echo "Flashing $filename..."
load_image $filename $flashstart
sleep 10
echo "Flash complete. Verifying....."
reset halt 
verify_image $filename $flashstart
test_image $filename $flashstart
sleep 10
reset halt
echo "Complete. Starting execution, shutting down openocd"
resume
sleep 10
shutdown
};
